package com.lhhs.loan.common.utils;

import java.io.IOException;

/**
 * @author terryyao
 *
 */
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.nodes.Node;
import org.jsoup.select.Elements;

public class NormalizeHTML {

  public static String removeElements(String html, String elementsTag) {
	    Document doc = Jsoup.parse(html);
        doc.outputSettings().charset("UTF-8");
	    Elements elements = doc.getElementsByTag(elementsTag);
	    elements.remove();
	    return doc.toString();
	  }
	  
  public static String updateTableWidth(String html) {
	  Document doc = Jsoup.parse(html);
		Elements table_widths = doc.select("table");
		for (Element table_width : table_widths) {
			String widthValue = table_width.attr("width");
			if (!StrUtils.isNullOrEmpty(widthValue) && !widthValue.contains("%") && Integer.valueOf(widthValue) >= 600) {
				table_widths.attr("width", "600");
			}
		}
		return doc.toString();
	  }
  
  public static void removeMetaDate(Document doc) {
    Elements elements = doc.getElementsByTag("meta");
    for (Element element : elements) {
      String attr = element.attr("name");
      if ("date".equals(attr)) {
        element.attr("content", "XXXXXXXXXXXXXXXXXXX");
      }
    }
  }

  // see: http://stackoverflow.com/questions/7541843/how-to-search-for-comments-using-jsoup
  public static void removeComments(Node node) {
    for (int i = 0; i < node.childNodes().size();) {
      Node child = node.childNode(i);
      if (child.nodeName().equals("#comment")) child.remove();
      else {
        removeComments(child);
        i++;
      }
    }
  }
  

  public static void main(String... args) throws IOException {
      String html = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"><style type=\"text/css\">\r\n      td,p,div,span {font-size:12px;color:#000000;font-family:宋体;}\r\n      td{line-height:20px;}\r\n      .btnbox{ width:600px; height:100px;}\r\n      .yelline{height:3px;  width:176px; float:left; margin-top:12px; font-size:1;}\r\n      .btnbox-mid{  float:left; text-align:center}\r\n      .btnbox-yelbtn{font:500 20px Microsoft YaHei; color:#fff; padding:5px 10px; background-color:#eb6100; text-decoration:none;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px; border-bottom:2px #e54d00 solid; }\r\n      .Clicktext{ color:#004e9c}\r\n      .footercont{width:600px; border-top:1px #e1e1e1 solid;text-align:center;line-height:20px; padding:10px 0;background:#f6f7f9;color:#a3a4a9;}\r\n      .space-left{padding-left:3px;}\r\n      .space{padding:0 3px 0 3px}\r\n    </style><span style=\"display:none;\">\r\n      ID:JM778541995R90250000000</span><table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f6f7f9\"><tr height=\"85\"><td align=\"right\" width=\"213\"><img src=\"http://images.zhaopin.com/2014/c/img/logo15624.png\" width=\"201\" height=\"70\"></td><td><a a=\"\" target=\"_blank\" href=\"http://rd2.zhaopin.com/portal/myrd/regnew.asp?za=2\"><img src=\"http://images.zhaopin.com/2014/c/img/eml_ban2.jpg?t=1\" width=\"370\" height=\"70\"></a></td></tr><tr><td height=\"3\" bgcolor=\"#3696d7\" colspan=\"2\"></tr><tr><td height=\"3\" bgcolor=\"#e0e1e3\" colspan=\"2\"></tr><tr><td height=\"10\"></tr></table><table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f6f7f9\" style=\"font-size: 12px;color: #000000;font-family: 宋体;\"><tr><td><table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td><table width=\"570\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#ffffff\" style=\"border:1px solid #ebebeb\"><tr><td colspan=\"3\" height=\"10\"></tr><tr><td valign=\"top\" width=\"466\"><table width=\"466\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"word-break: break-all; word-wrap:break-word;\"><tr style=\"width:100%;height:50px\"><td style=\"font-size:22px;color:#333333;font-family:'微软雅黑';padding-left:12px;line-height:50px\">武京都</td></tr><tr width=\"466\" style=\"height:30px\"><td width=\"466\" style=\"font-size:12px;color:#000000;line-height:24px;padding-left:12px;word-break: break-all; word-wrap:break-word;\"><font style=\"font-weight:bold\">男</font><small style=\"color:#b5b5b5\" class=\"space\">|</small><font style=\"font-weight:bold\">4年工作经验</font><small style=\"color:#b5b5b5\" class=\"space\">|</small><font style=\"font-weight:bold\">1992年6月</font><small style=\"color:#b5b5b5\" class=\"space\">|</small><font style=\"font-weight:bold\">未婚</font><br>现居住于北京-昌平区<small style=\"color:#b5b5b5\" class=\"space\">|</small>本科<small style=\"color:#b5b5b5;word-break:break-all;\" class=\"space-left\">|</small>山西-运城户口\r\n                            </td></tr><tr><td><table><tr height=\"54\"><td width=\"4\"><td width=\"210\" height=\"54\" style=\"background:#2f9ddf;border-radius:4px;word-break: break-all; word-wrap:break-word;padding-left:5px;padding-bottom:5px;\"><p style=\"font-size:22px;color:#fff;font-weight:bold;line-height:35px;padding:0;margin:0;padding-left:7px;font-family:Arial;\">17326936402</p><span style=\"display:block;padding:0 0 0 7px;margin:0;font-family:Arial;font-size:12px;color:#fff;\">17326936402@163.com</span></td><td width=\"4\"><td width=\"80\" height=\"54\" style=\"background:#ef8f00;text-align:center;border-radius:4px;\"><a style=\"font-size:14px;color:#ffffff;text-decoration:none;\" href=\"http://cnt.zhaopin.com/Market/whole_counter.jsp?sid=121125266&amp;site=&amp;url=http://rd.zhaopin.com/resumepreview/resume/viewone/1/4665807071\">\r\n                                          暂不合适\r\n                                        </a></td><td width=\"4\"><td width=\"160\"><a style=\"color:#315aaa\" href=\"http://cnt.zhaopin.com/Market/whole_counter.jsp?sid=121125267&amp;site=&amp;url=http://jobads.zhaopin.com/Position/RecommendResumes4Position/CC664788322J90250982000\">\r\n                                          更多该职位人才精准推荐\r\n                                        </a></td></tr></table></td></tr></table></td><td width=\"80\"><div class=\"photo\" style=\"padding: 0px 5px 5px 5px\"><a target=\"_blank\" href=\"http://mypics.zhaopin.com/pic/2016/9/4/2652b123-03bd-4674-be42-4bcf33fcf5ee.jpg\"><img border=\"\r\n                              0\r\n                            \" width=\"\r\n                              70\r\n                            \" height=\"\r\n                              90\r\n                            \" style=\"\r\n                              vertical-align:middle\r\n                            \" src=\"http://mypics.zhaopin.com/pic/2016/9/4/2652b123-03bd-4674-be42-4bcf33fcf5ee.jpg\"></a></div></td><td width=\"6\"></tr><tr><td colspan=\"3\" height=\"10\"></tr></table></td></tr><tr><td height=\"10\"></tr><tr><td><table width=\"570\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"word-break: break-all; word-wrap:break-word;\"></td></tr><tr><td><table width=\"570\" height=\"30\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#429bd8\"><tr><td style=\"border:1px solid #ebebeb;padding-left:5px;word-break: break-all; word-wrap:break-word;\"><span style=\"color:#ffffff;font-size:14px;\">自我评价</span></td></tr></table><table width=\"570\"><tr><td colspan=\"2\" height=\"5\"></tr><tr><td colspan=\"2\" style=\"line-height:18px;word-break:break-all;word-wrap:break-word;padding-left:12px;\">个人：<br>个人：<br>性格幽默开朗，积极向上有自信，善于活跃气氛；热爱设计，敢于创新，对色彩有很好的把控，做事情专注有耐心；喜欢团队型活动<br><br>专业：<br>1、四年以上互联网/移动互联网产品设计经验；<br>2、对移动端/WEB端界面风格设计有独特的看法，可以帮助产品经理设计低保真原型图、参与产品的前期需求，收集整理和用户调研，并且能独立完成界面高保真设计；<br>3、有很好的UI设计基础，可以独立完成WEB端、移动端视觉设计和产品项目设计工作；<br>4、工作态度认真负责，具备团队协作沟通能力和观察学习能力，能够胜任高强度的工作节奏；<br>5、具备很强的适应能力，能够快速适应公司的环境，并且具有一定的写作能力；<br>6、有一定的手绘能力，喜欢研究一些动效交互；<br>7、熟悉HTML5&#43;CSS3排版<br>8、喜欢尝试新的行业，学习新的行业知识，喜欢有激情的工作，有压力才有动力；</td></tr><tr><td colspan=\"2\" height=\"5\"></tr></table></td></tr><tr><td><br><table width=\"570\" height=\"30\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#429bd8\"><tr><td style=\"border:1px solid #ebebeb;padding-left:5px;\"><span style=\"color:#ffffff;font-size:14px;\">求职意向</span></td></tr></table><br><table width=\"570\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td width=\"95\" align=\"right\" valign=\"top\">期望工作地区：</td><td width=\"475\" valign=\"top\">北京</td></tr><tr><td width=\"95\" align=\"right\" valign=\"top\">期望工作性质：</td><td width=\"475\" valign=\"top\">全职</td></tr><tr><td width=\"95\" align=\"right\" valign=\"top\">期望从事职业：</td><td width=\"475\" valign=\"top\">用户界面（UI）设计、用户体验（UE/UX）设计、网页设计/制作/美工、</td></tr><tr><td width=\"95\" align=\"right\" valign=\"top\">期望月薪：</td><td width=\"475\" valign=\"top\">15000-25000元/月</td></tr><tr><td width=\"95\" align=\"right\" valign=\"top\">目前状况：</td><td width=\"475\" valign=\"top\">我目前处于离职状态，可立即上岗</td></tr><tr><td width=\"95\" align=\"right\" valign=\"top\">期望从事行业：</td><td width=\"475\" valign=\"top\">互联网/电子商务</td></tr></table></td></tr><tr><td><br><table width=\"570\" height=\"30\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#429bd8\"><tr><td style=\"border:1px solid #ebebeb;padding-left:5px;\"><span style=\"color:#ffffff;font-size:14px;\">工作经历</span></td></tr></table><br><table width=\"570\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"color:#333333;\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin-bottom:15px;word-break: break-all; word-wrap:break-word;\"><tr><td width=\"132\" height=\"22\" style=\"text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\"><p style=\"width:132px;text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\">2015/08\r\n                                    - \r\n                                        至今\r\n                                      </p></td><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px\">网易（杭州）网络有限公司</span><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">\r\n                                    （1年1个月）\r\n                                  </span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word; font-size:12px; font-family:'新宋体';\"><span style=\"display:inline-block;margin:0 2px\">高级ui设计师</span><font style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">|</font><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">15000-25000元/月</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">互联网/电子商务</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><p style=\"line-height:20px;\"><span>工作描述：</span>1.主要负责LOFTER的移动客户端产品视觉的优化，根据产品需求配合产品经理设计出优质的高保真呈现和一些交互设计的工作；<br>2.根据各种相关软件的用户群，提出构思新颖、有高度吸引力的创意设计；<br>3.维护现有的应用产品，对页面进行优化，使用户操作更趋于人性化。<br>4.有较强的团队协作能力和沟通能力，能够和上级领导有效沟通解决问题；<br><br>链接：http://www.lofter.com/login?urschecked=true</p></td></tr></table></td></tr><tr><td style=\"color:#333333;\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin-bottom:15px;word-break: break-all; word-wrap:break-word;\"><tr><td width=\"132\" height=\"22\" style=\"text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\"><p style=\"width:132px;text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\">2013/10\r\n                                    - 2015/07</p></td><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px\">北京协力筑成金融信息服务股份有限公司</span><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">\r\n                                    （1年9个月）\r\n                                  </span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word; font-size:12px; font-family:'新宋体';\"><span style=\"display:inline-block;margin:0 2px\">ui设计师</span><font style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">|</font><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">10001-15000元/月</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">互联网/电子商务</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><p style=\"line-height:20px;\"><span>工作描述：</span>1、负责公司互联网产品和客户产品设计，包括：网站、VI设计，广告宣传等&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>2、配合产品经理、用户研究员进行市场调研、用户研究和竞品分析，完成界面的信息架构、流程设计、和界面设计，参与UE设计讨论，给出UI、UE方面建议，提出自己的想法，根据需求，完善优化视觉用户体验；<br>3、负责设计人机交互界面结构、用户操作流程、输出高保真原型，根据视觉设计的发展趋势及用户研究的结果不断优化产品的视觉体验<br>4、与客户沟通联系，落实设计方案，包括基本用料，色调及风格等<br>5、跟踪产品的用户反馈，对现有产品的可用性测试和评估，提出改善方案，不断优化用户体验；</p></td></tr></table></td></tr><tr><td style=\"color:#333333;\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin-bottom:15px;word-break: break-all; word-wrap:break-word;\"><tr><td width=\"132\" height=\"22\" style=\"text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\"><p style=\"width:132px;text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\">2012/06\r\n                                    - 2013/08</p></td><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px\">北京宏源思博科技有限公司</span><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">\r\n                                    （1年2个月）\r\n                                  </span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px; font-weight:bold;word-break: break-all; word-wrap:break-word; font-size:12px; font-family:'新宋体';\"><span style=\"display:inline-block;margin:0 2px\">ui设计师</span><font style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">|</font><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">8001-10000元/月</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><span style=\"display:inline-block;margin:0 2px; font-size:12px; font-family:'新宋体';\">互联网/电子商务</span></td></tr><tr><td width=\"132\" height=\"22\"><td width=\"424\" style=\"padding-left:14px;word-break: break-all; word-wrap:break-word;\"><p style=\"line-height:20px;\"><span>工作描述：</span>1、主要根据客户提出的需求设计出企业站，电子商务，手机移动端的高保真设计稿；<br>2、通过原有网站的功能架构分析，根据当前流行趋势，改版整体企业站的设计风格和细节优化；<br>3、根据需求负责网站相关图片处理；<br>4、负责网站的交互设计，根据产品经理的需求文档，配合产品经理分析需求，产出原型图；</p></td></tr></table></td></tr></table></td></tr><tr><td><br><table width=\"570\" height=\"30\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#429bd8\"><tr><td style=\"border:1px solid #ebebeb;padding-left:5px;\"><span style=\"color:#ffffff;font-size:14px;\">教育经历</span></td></tr></table><br><table width=\"570\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"color:#333333;word-break: break-all; word-wrap:break-word;\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr height=\"20\"><td width=\"132\" style=\" font-size:12px; font-family:'新宋体';\" valign=\"top\"><p style=\"width:132px;text-align:right;font-weight:bold; font-size:12px; font-family:'新宋体';\">2010/09 - 2014/07</p></td><td width=\"412\" style=\"word-break: break-all; word-wrap:break-word;padding-left:12px;\"><span style=\"display:inline-block;margin-right:12px;font-weight:normal;\">河北传媒学院</span><span style=\"display:inline-block;margin-right:12px;font-weight:normal;\">\r\n                                    &nbsp;视觉传达设计</span><span style=\"display:inline-block;margin-right:12px;font-weight:normal;\">\r\n                                      &nbsp;统招</span><span style=\"display:inline-block;margin-right:12px;font-weight:normal;\">\r\n                                    &nbsp;本科</span></td></tr></table></td></tr></table></td></tr></table></td></tr></table><br><table width=\"600\" height=\"80\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" bgcolor=\"#f6f7f9\"><tr><td width=\"165\"><td width=\"270\" style=\"text-align:center;\"><a style=\"display:inline-block;font:500 20px Microsoft YaHei; color:#ffffff; padding:5px 10px; background-color:#eb6100; text-decoration:none;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px; border-bottom:2px #e54d00 solid;\" href=\"http://cnt.zhaopin.com/Market/whole_counter.jsp?sid=121125267&amp;site=&amp;url=http://jobads.zhaopin.com/Position/RecommendResumes4Position/CC664788322J90250982000\">&nbsp;更多该职位人才精准推荐&nbsp;\r\n            </a></td><td width=\"165\"></tr></table>\r\n\r\n";
      
	  Document doc = Jsoup.parse(html);
		Elements table_widths = doc.select("table");
		for (Element table_width : table_widths) {
			String widthValue = table_width.attr("width");
			if (!StrUtils.isNullOrEmpty(widthValue) && !widthValue.contains("%") && Integer.valueOf(widthValue) >= 600) {
				table_widths.attr("width", "600");
			}
		}
		  System.out.println(doc.toString());	  
      //System.out.println(removeElements(html, "meta"));
  }
}