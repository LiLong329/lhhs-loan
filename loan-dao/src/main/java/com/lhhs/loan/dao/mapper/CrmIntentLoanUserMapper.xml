<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lhhs.loan.dao.CrmIntentLoanUserMapper" >
  <resultMap id="BaseResultMap" type="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="mobile" property="mobile" jdbcType="VARCHAR" />
    <result column="cust_id" property="custId" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="sex" property="sex" jdbcType="INTEGER" />
    <result column="age" property="age" jdbcType="INTEGER" />
    <result column="province" property="province" jdbcType="VARCHAR" />
    <result column="city" property="city" jdbcType="VARCHAR" />
    <result column="house_address" property="houseAddress" jdbcType="VARCHAR" />
    <result column="loan_amount" property="loanAmount" jdbcType="VARCHAR" />
    <result column="interest_rate" property="interestRate" jdbcType="VARCHAR" />
    <result column="rate_unit" property="rateUnit" jdbcType="VARCHAR" />
    <result column="duration" property="duration" jdbcType="VARCHAR" />
    <result column="duration_unit" property="durationUnit" jdbcType="VARCHAR" />
    <result column="id_number" property="idNumber" jdbcType="VARCHAR" />
    <result column="business_type" property="businessType" jdbcType="VARCHAR" />
    <result column="seat_number" property="seatNumber" jdbcType="VARCHAR" />
    <result column="extend_param" property="extendParam" jdbcType="VARCHAR" />
    <result column="creater_emp_id" property="createrEmpId" jdbcType="VARCHAR" />
    <result column="creater_emp_name" property="createrEmpName" jdbcType="VARCHAR" />
    <result column="creater_union_id" property="createrUnionId" jdbcType="VARCHAR" />
    <result column="creater_company_id" property="createrCompanyId" jdbcType="VARCHAR" />
    <result column="creater_dep_id" property="createrDepId" jdbcType="VARCHAR" />
    <result column="creater_group_id" property="createrGroupId" jdbcType="VARCHAR" />
    <result column="creater_org" property="createrOrg" jdbcType="VARCHAR" />
    <result column="appoint_emp_id" property="appointEmpId" jdbcType="VARCHAR" />
    <result column="appoint_emp_name" property="appointEmpName" jdbcType="VARCHAR" />
    <result column="appoint_union_id" property="appointUnionId" jdbcType="VARCHAR" />
    <result column="appoint_company_id" property="appointCompanyId" jdbcType="VARCHAR" />
    <result column="appoint_dep_id" property="appointDepId" jdbcType="VARCHAR" />
    <result column="appoint_group_id" property="appointGroupId" jdbcType="VARCHAR" />
    <result column="appoint_org" property="appointOrg" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="business_status" property="businessStatus" jdbcType="VARCHAR" />
    <result column="visit_count" property="visitCount" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="visit_time" property="visitTime" jdbcType="TIMESTAMP" />
    <result column="last_user" property="lastUser" jdbcType="VARCHAR" />
    <result column="last_modify_time" property="lastModifyTime" jdbcType="TIMESTAMP" />
    <result column="source" property="source" jdbcType="VARCHAR" />
    <result column="source_org" property="sourceOrg" jdbcType="VARCHAR" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="grade" property="grade" jdbcType="VARCHAR" />
    <result column="field1" property="field1" jdbcType="VARCHAR" />
    <result column="field2" property="field2" jdbcType="VARCHAR" />
    <result column="field3" property="field3" jdbcType="VARCHAR" />
    <result column="field4" property="field4" jdbcType="VARCHAR" />
    <result column="field5" property="field5" jdbcType="VARCHAR" />
    <result column="field6" property="field6" jdbcType="VARCHAR" />
    <result column="field7" property="field7" jdbcType="VARCHAR" />
    <result column="field8" property="field8" jdbcType="VARCHAR" />
    <result column="field9" property="field9" jdbcType="VARCHAR" />
    <result column="field10" property="field10" jdbcType="VARCHAR" />
    <result column="parent_id" property="parentId" jdbcType="INTEGER" />
    <result column="dept_name" property="deptName" jdbcType="VARCHAR" />
    <result column="creater_org" property="createrOrg" jdbcType="VARCHAR" />
	<result column="appoint_org" property="appointOrg" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, mobile, cust_id, name, sex, age, province, city, house_address, loan_amount, 
    interest_rate, rate_unit, duration, duration_unit, id_number, business_type, seat_number, 
    extend_param, creater_emp_id, creater_emp_name, creater_union_id, creater_company_id, 
    creater_dep_id, creater_group_id, creater_org, appoint_emp_id, appoint_emp_name, 
    appoint_union_id, appoint_company_id, appoint_dep_id, appoint_group_id, appoint_org, 
    status, business_status, visit_count, create_time, visit_time, last_user, last_modify_time, 
    source, source_org, remark, grade, field1, field2, field3, field4, field5, field6, 
    field7, field8, field9, field10, parent_id
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" >
    select 
    <include refid="Base_Column_List" />
    from crm_intent_loan_user
    where id = #{id}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from crm_intent_loan_user
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    insert into crm_intent_loan_user (id, mobile, cust_id, 
      name, sex, age, province, 
      city, house_address, loan_amount, 
      interest_rate, rate_unit, duration, 
      duration_unit, id_number, business_type, 
      seat_number, extend_param, creater_emp_id, 
      creater_emp_name, creater_union_id, creater_company_id, 
      creater_dep_id, creater_group_id, creater_org, 
      appoint_emp_id, appoint_emp_name, appoint_union_id, 
      appoint_company_id, appoint_dep_id, appoint_group_id, 
      appoint_org, status, business_status, 
      visit_count, create_time, visit_time, 
      last_user, last_modify_time, source, 
      source_org, remark, grade, 
      field1, field2, field3, 
      field4, field5, field6, 
      field7, field8, field9, 
      field10, parent_id)
    values (#{id,jdbcType=INTEGER}, #{mobile,jdbcType=VARCHAR}, #{custId,jdbcType=VARCHAR}, 
      #{name,jdbcType=VARCHAR}, #{sex,jdbcType=INTEGER}, #{age,jdbcType=INTEGER}, #{province,jdbcType=VARCHAR}, 
      #{city,jdbcType=VARCHAR}, #{houseAddress,jdbcType=VARCHAR}, #{loanAmount,jdbcType=VARCHAR}, 
      #{interestRate,jdbcType=VARCHAR}, #{rateUnit,jdbcType=VARCHAR}, #{duration,jdbcType=VARCHAR}, 
      #{durationUnit,jdbcType=VARCHAR}, #{idNumber,jdbcType=VARCHAR}, #{businessType,jdbcType=INTEGER}, 
      #{seatNumber,jdbcType=VARCHAR}, #{extendParam,jdbcType=VARCHAR}, #{createrEmpId,jdbcType=VARCHAR}, 
      #{createrEmpName,jdbcType=VARCHAR}, #{createrUnionId,jdbcType=VARCHAR}, #{createrCompanyId,jdbcType=VARCHAR}, 
      #{createrDepId,jdbcType=VARCHAR}, #{createrGroupId,jdbcType=VARCHAR}, #{createrOrg,jdbcType=VARCHAR}, 
      #{appointEmpId,jdbcType=VARCHAR}, #{appointEmpName,jdbcType=VARCHAR}, #{appointUnionId,jdbcType=VARCHAR}, 
      #{appointCompanyId,jdbcType=VARCHAR}, #{appointDepId,jdbcType=VARCHAR}, #{appointGroupId,jdbcType=VARCHAR}, 
      #{appointOrg,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, #{businessStatus,jdbcType=VARCHAR}, 
      #{visitCount,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP}, #{visitTime,jdbcType=TIMESTAMP}, 
      #{lastUser,jdbcType=VARCHAR}, #{lastModifyTime,jdbcType=TIMESTAMP}, #{source,jdbcType=VARCHAR}, 
      #{sourceOrg,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR}, #{grade,jdbcType=VARCHAR}, 
      #{field1,jdbcType=VARCHAR}, #{field2,jdbcType=VARCHAR}, #{field3,jdbcType=VARCHAR}, 
      #{field4,jdbcType=VARCHAR}, #{field5,jdbcType=VARCHAR}, #{field6,jdbcType=VARCHAR}, 
      #{field7,jdbcType=VARCHAR}, #{field8,jdbcType=VARCHAR}, #{field9,jdbcType=VARCHAR}, 
      #{field10,jdbcType=VARCHAR}, #{parentId,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    insert into crm_intent_loan_user
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="mobile != null" >
        mobile,
      </if>
      <if test="custId != null" >
        cust_id,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="sex != null" >
        sex,
      </if>
      <if test="age != null" >
        age,
      </if>
      <if test="province != null" >
        province,
      </if>
      <if test="city != null" >
        city,
      </if>
      <if test="houseAddress != null" >
        house_address,
      </if>
      <if test="loanAmount != null" >
        loan_amount,
      </if>
      <if test="interestRate != null" >
        interest_rate,
      </if>
      <if test="rateUnit != null" >
        rate_unit,
      </if>
      <if test="duration != null" >
        duration,
      </if>
      <if test="durationUnit != null" >
        duration_unit,
      </if>
      <if test="idNumber != null" >
        id_number,
      </if>
      <if test="businessType != null" >
        business_type,
      </if>
      <if test="seatNumber != null" >
        seat_number,
      </if>
      <if test="extendParam != null" >
        extend_param,
      </if>
      <if test="createrEmpId != null" >
        creater_emp_id,
      </if>
      <if test="createrEmpName != null" >
        creater_emp_name,
      </if>
      <if test="createrUnionId != null" >
        creater_union_id,
      </if>
      <if test="createrCompanyId != null" >
        creater_company_id,
      </if>
      <if test="createrDepId != null" >
        creater_dep_id,
      </if>
      <if test="createrGroupId != null" >
        creater_group_id,
      </if>
      <if test="createrOrg != null" >
        creater_org,
      </if>
      <if test="appointEmpId != null" >
        appoint_emp_id,
      </if>
      <if test="appointEmpName != null" >
        appoint_emp_name,
      </if>
      <if test="appointUnionId != null" >
        appoint_union_id,
      </if>
      <if test="appointCompanyId != null" >
        appoint_company_id,
      </if>
      <if test="appointDepId != null" >
        appoint_dep_id,
      </if>
      <if test="appointGroupId != null" >
        appoint_group_id,
      </if>
      <if test="appointOrg != null" >
        appoint_org,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="businessStatus != null" >
        business_status,
      </if>
      <if test="visitCount != null" >
        visit_count,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
      <if test="visitTime != null" >
        visit_time,
      </if>
      <if test="lastUser != null" >
        last_user,
      </if>
      <if test="lastModifyTime != null" >
        last_modify_time,
      </if>
      <if test="source != null" >
        source,
      </if>
      <if test="sourceOrg != null" >
        source_org,
      </if>
      <if test="remark != null" >
        remark,
      </if>
      <if test="grade != null" >
        grade,
      </if>
      <if test="field1 != null" >
        field1,
      </if>
      <if test="field2 != null" >
        field2,
      </if>
      <if test="field3 != null" >
        field3,
      </if>
      <if test="field4 != null" >
        field4,
      </if>
      <if test="field5 != null" >
        field5,
      </if>
      <if test="field6 != null" >
        field6,
      </if>
      <if test="field7 != null" >
        field7,
      </if>
      <if test="field8 != null" >
        field8,
      </if>
      <if test="field9 != null" >
        field9,
      </if>
      <if test="field10 != null" >
        field10,
      </if>
      <if test="parentId != null" >
        parent_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="mobile != null" >
        #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="custId != null" >
        #{custId,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        #{sex,jdbcType=INTEGER},
      </if>
      <if test="age != null" >
        #{age,jdbcType=INTEGER},
      </if>
      <if test="province != null" >
        #{province,jdbcType=VARCHAR},
      </if>
      <if test="city != null" >
        #{city,jdbcType=VARCHAR},
      </if>
      <if test="houseAddress != null" >
        #{houseAddress,jdbcType=VARCHAR},
      </if>
      <if test="loanAmount != null" >
        #{loanAmount,jdbcType=VARCHAR},
      </if>
      <if test="interestRate != null" >
        #{interestRate,jdbcType=VARCHAR},
      </if>
      <if test="rateUnit != null" >
        #{rateUnit,jdbcType=VARCHAR},
      </if>
      <if test="duration != null" >
        #{duration,jdbcType=VARCHAR},
      </if>
      <if test="durationUnit != null" >
        #{durationUnit,jdbcType=VARCHAR},
      </if>
      <if test="idNumber != null" >
        #{idNumber,jdbcType=VARCHAR},
      </if>
      <if test="businessType != null" >
        #{businessType,jdbcType=VARCHAR},
      </if>
      <if test="seatNumber != null" >
        #{seatNumber,jdbcType=VARCHAR},
      </if>
      <if test="extendParam != null" >
        #{extendParam,jdbcType=VARCHAR},
      </if>
      <if test="createrEmpId != null" >
        #{createrEmpId,jdbcType=VARCHAR},
      </if>
      <if test="createrEmpName != null" >
        #{createrEmpName,jdbcType=VARCHAR},
      </if>
      <if test="createrUnionId != null" >
        #{createrUnionId,jdbcType=VARCHAR},
      </if>
      <if test="createrCompanyId != null" >
        #{createrCompanyId,jdbcType=VARCHAR},
      </if>
      <if test="createrDepId != null" >
        #{createrDepId,jdbcType=VARCHAR},
      </if>
      <if test="createrGroupId != null" >
        #{createrGroupId,jdbcType=VARCHAR},
      </if>
      <if test="createrOrg != null" >
        #{createrOrg,jdbcType=VARCHAR},
      </if>
      <if test="appointEmpId != null" >
        #{appointEmpId,jdbcType=VARCHAR},
      </if>
      <if test="appointEmpName != null" >
        #{appointEmpName,jdbcType=VARCHAR},
      </if>
      <if test="appointUnionId != null" >
        #{appointUnionId,jdbcType=VARCHAR},
      </if>
      <if test="appointCompanyId != null" >
        #{appointCompanyId,jdbcType=VARCHAR},
      </if>
      <if test="appointDepId != null" >
        #{appointDepId,jdbcType=VARCHAR},
      </if>
      <if test="appointGroupId != null" >
        #{appointGroupId,jdbcType=VARCHAR},
      </if>
      <if test="appointOrg != null" >
        #{appointOrg,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="businessStatus != null" >
        #{businessStatus,jdbcType=VARCHAR},
      </if>
      <if test="visitCount != null" >
        #{visitCount,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="visitTime != null" >
        #{visitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastUser != null" >
        #{lastUser,jdbcType=VARCHAR},
      </if>
      <if test="lastModifyTime != null" >
        #{lastModifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="source != null" >
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="sourceOrg != null" >
        #{sourceOrg,jdbcType=VARCHAR},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="grade != null" >
        #{grade,jdbcType=VARCHAR},
      </if>
      <if test="field1 != null" >
        #{field1,jdbcType=VARCHAR},
      </if>
      <if test="field2 != null" >
        #{field2,jdbcType=VARCHAR},
      </if>
      <if test="field3 != null" >
        #{field3,jdbcType=VARCHAR},
      </if>
      <if test="field4 != null" >
        #{field4,jdbcType=VARCHAR},
      </if>
      <if test="field5 != null" >
        #{field5,jdbcType=VARCHAR},
      </if>
      <if test="field6 != null" >
        #{field6,jdbcType=VARCHAR},
      </if>
      <if test="field7 != null" >
        #{field7,jdbcType=VARCHAR},
      </if>
      <if test="field8 != null" >
        #{field8,jdbcType=VARCHAR},
      </if>
      <if test="field9 != null" >
        #{field9,jdbcType=VARCHAR},
      </if>
      <if test="field10 != null" >
        #{field10,jdbcType=VARCHAR},
      </if>
      <if test="parentId != null" >
        #{parentId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    update crm_intent_loan_user
    <set >
      <if test="mobile != null" >
        mobile = #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="custId != null" >
        cust_id = #{custId,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        sex = #{sex,jdbcType=INTEGER},
      </if>
      <if test="age != null" >
        age = #{age,jdbcType=INTEGER},
      </if>
      <if test="province != null" >
        province = #{province,jdbcType=VARCHAR},
      </if>
      <if test="city != null" >
        city = #{city,jdbcType=VARCHAR},
      </if>
      <if test="houseAddress != null" >
        house_address = #{houseAddress,jdbcType=VARCHAR},
      </if>
      <if test="loanAmount != null" >
        loan_amount = #{loanAmount,jdbcType=VARCHAR},
      </if>
      <if test="interestRate != null" >
        interest_rate = #{interestRate,jdbcType=VARCHAR},
      </if>
      <if test="rateUnit != null" >
        rate_unit = #{rateUnit,jdbcType=VARCHAR},
      </if>
      <if test="duration != null" >
        duration = #{duration,jdbcType=VARCHAR},
      </if>
      <if test="durationUnit != null" >
        duration_unit = #{durationUnit,jdbcType=VARCHAR},
      </if>
      <if test="idNumber != null" >
        id_number = #{idNumber,jdbcType=VARCHAR},
      </if>
      <if test="businessType != null" >
        business_type = #{businessType,jdbcType=VARCHAR},
      </if>
      <if test="seatNumber != null" >
        seat_number = #{seatNumber,jdbcType=VARCHAR},
      </if>
      <if test="extendParam != null" >
        extend_param = #{extendParam,jdbcType=VARCHAR},
      </if>
      <if test="createrEmpId != null" >
        creater_emp_id = #{createrEmpId,jdbcType=VARCHAR},
      </if>
      <if test="createrEmpName != null" >
        creater_emp_name = #{createrEmpName,jdbcType=VARCHAR},
      </if>
      <if test="createrUnionId != null" >
        creater_union_id = #{createrUnionId,jdbcType=VARCHAR},
      </if>
      <if test="createrCompanyId != null" >
        creater_company_id = #{createrCompanyId,jdbcType=VARCHAR},
      </if>
      <if test="createrDepId != null" >
        creater_dep_id = #{createrDepId,jdbcType=VARCHAR},
      </if>
      <if test="createrGroupId != null" >
        creater_group_id = #{createrGroupId,jdbcType=VARCHAR},
      </if>
      <if test="createrOrg != null" >
        creater_org = #{createrOrg,jdbcType=VARCHAR},
      </if>
      <if test="appointEmpId != null" >
        appoint_emp_id = #{appointEmpId,jdbcType=VARCHAR},
      </if>
      <if test="appointEmpName != null" >
        appoint_emp_name = #{appointEmpName,jdbcType=VARCHAR},
      </if>
      <if test="appointUnionId != null" >
        appoint_union_id = #{appointUnionId,jdbcType=VARCHAR},
      </if>
      <if test="appointCompanyId != null" >
        appoint_company_id = #{appointCompanyId,jdbcType=VARCHAR},
      </if>
      <if test="appointDepId != null" >
        appoint_dep_id = #{appointDepId,jdbcType=VARCHAR},
      </if>
      <if test="appointGroupId != null" >
        appoint_group_id = #{appointGroupId,jdbcType=VARCHAR},
      </if>
      <if test="appointOrg != null" >
        appoint_org = #{appointOrg,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="businessStatus != null" >
        business_status = #{businessStatus,jdbcType=VARCHAR},
      </if>
      <if test="visitCount != null" >
        visit_count = #{visitCount,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="visitTime != null" >
        visit_time = #{visitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastUser != null" >
        last_user = #{lastUser,jdbcType=VARCHAR},
      </if>
      <if test="lastModifyTime != null" >
        last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="source != null" >
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="sourceOrg != null" >
        source_org = #{sourceOrg,jdbcType=VARCHAR},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="grade != null" >
        grade = #{grade,jdbcType=VARCHAR},
      </if>
      <if test="field1 != null" >
        field1 = #{field1,jdbcType=VARCHAR},
      </if>
      <if test="field2 != null" >
        field2 = #{field2,jdbcType=VARCHAR},
      </if>
      <if test="field3 != null" >
        field3 = #{field3,jdbcType=VARCHAR},
      </if>
      <if test="field4 != null" >
        field4 = #{field4,jdbcType=VARCHAR},
      </if>
      <if test="field5 != null" >
        field5 = #{field5,jdbcType=VARCHAR},
      </if>
      <if test="field6 != null" >
        field6 = #{field6,jdbcType=VARCHAR},
      </if>
      <if test="field7 != null" >
        field7 = #{field7,jdbcType=VARCHAR},
      </if>
      <if test="field8 != null" >
        field8 = #{field8,jdbcType=VARCHAR},
      </if>
      <if test="field9 != null" >
        field9 = #{field9,jdbcType=VARCHAR},
      </if>
      <if test="field10 != null" >
        field10 = #{field10,jdbcType=VARCHAR},
      </if>
      <if test="parentId != null" >
        parent_id = #{parentId,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    update crm_intent_loan_user
    set mobile = #{mobile,jdbcType=VARCHAR},
      cust_id = #{custId,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      sex = #{sex,jdbcType=INTEGER},
      age = #{age,jdbcType=INTEGER},
      province = #{province,jdbcType=VARCHAR},
      city = #{city,jdbcType=VARCHAR},
      house_address = #{houseAddress,jdbcType=VARCHAR},
      loan_amount = #{loanAmount,jdbcType=VARCHAR},
      interest_rate = #{interestRate,jdbcType=VARCHAR},
      rate_unit = #{rateUnit,jdbcType=VARCHAR},
      duration = #{duration,jdbcType=VARCHAR},
      duration_unit = #{durationUnit,jdbcType=VARCHAR},
      id_number = #{idNumber,jdbcType=VARCHAR},
      business_type = #{businessType,jdbcType=INTEGER},
      seat_number = #{seatNumber,jdbcType=VARCHAR},
      extend_param = #{extendParam,jdbcType=VARCHAR},
      creater_emp_id = #{createrEmpId,jdbcType=VARCHAR},
      creater_emp_name = #{createrEmpName,jdbcType=VARCHAR},
      creater_union_id = #{createrUnionId,jdbcType=VARCHAR},
      creater_company_id = #{createrCompanyId,jdbcType=VARCHAR},
      creater_dep_id = #{createrDepId,jdbcType=VARCHAR},
      creater_group_id = #{createrGroupId,jdbcType=VARCHAR},
      creater_org = #{createrOrg,jdbcType=VARCHAR},
      appoint_emp_id = #{appointEmpId,jdbcType=VARCHAR},
      appoint_emp_name = #{appointEmpName,jdbcType=VARCHAR},
      appoint_union_id = #{appointUnionId,jdbcType=VARCHAR},
      appoint_company_id = #{appointCompanyId,jdbcType=VARCHAR},
      appoint_dep_id = #{appointDepId,jdbcType=VARCHAR},
      appoint_group_id = #{appointGroupId,jdbcType=VARCHAR},
      appoint_org = #{appointOrg,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      business_status = #{businessStatus,jdbcType=VARCHAR},
      visit_count = #{visitCount,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      visit_time = #{visitTime,jdbcType=TIMESTAMP},
      last_user = #{lastUser,jdbcType=VARCHAR},
      last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP},
      source = #{source,jdbcType=VARCHAR},
      source_org = #{sourceOrg,jdbcType=VARCHAR},
      remark = #{remark,jdbcType=VARCHAR},
      grade = #{grade,jdbcType=VARCHAR},
      field1 = #{field1,jdbcType=VARCHAR},
      field2 = #{field2,jdbcType=VARCHAR},
      field3 = #{field3,jdbcType=VARCHAR},
      field4 = #{field4,jdbcType=VARCHAR},
      field5 = #{field5,jdbcType=VARCHAR},
      field6 = #{field6,jdbcType=VARCHAR},
      field7 = #{field7,jdbcType=VARCHAR},
      field8 = #{field8,jdbcType=VARCHAR},
      field9 = #{field9,jdbcType=VARCHAR},
      field10 = #{field10,jdbcType=VARCHAR},
      parent_id = #{parentId,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
   <sql id="Where_Clause" >
    <where >
     <if test="mobile != null and mobile !=''" >
       and mobile = #{mobile,jdbcType=VARCHAR}
      </if>
      <if test="custId != null" >
       and cust_id = #{custId,jdbcType=VARCHAR}
      </if>
      <if test="name != null and name !=''" >
        and name like CONCAT('%', #{name}, '%')
      </if>
      <if test="sex != null" >
       and sex = #{sex,jdbcType=INTEGER}
      </if>
      <if test="age != null" >
       and age = #{age,jdbcType=INTEGER}
      </if>
      <if test="province != null" >
       and province = #{province,jdbcType=VARCHAR}
      </if>
      <if test="city != null" >
       and city = #{city,jdbcType=VARCHAR}
      </if>
      <if test="houseAddress != null" >
       and house_address = #{houseAddress,jdbcType=VARCHAR}
      </if>
      <if test="loanAmount != null" >
       and loan_amount = #{loanAmount,jdbcType=VARCHAR}
      </if>
      <if test="interestRate != null" >
       and interest_rate = #{interestRate,jdbcType=VARCHAR}
      </if>
      <if test="duration != null" >
       and duration = #{duration,jdbcType=VARCHAR}
      </if>
      <if test="idNumber != null" >
       and id_number = #{idNumber,jdbcType=VARCHAR}
      </if>
      <if test="businessType != null" >
       and business_type = #{businessType,jdbcType=INTEGER}
      </if>
      <if test="seatNumber != null" >
       and seat_number = #{seatNumber,jdbcType=VARCHAR}
      </if>
      <if test="extendParam != null" >
       and extend_param = #{extendParam,jdbcType=VARCHAR}
      </if>
      <if test="createrEmpId != null" >
       and creater_emp_id = #{createrEmpId,jdbcType=VARCHAR}
      </if>
      <if test="createrEmpName != null" >
       and creater_emp_name = #{createrEmpName,jdbcType=VARCHAR}
      </if>
      <if test="createrUnionId != null" >
       and  creater_union_id = #{createrUnionId,jdbcType=VARCHAR}
      </if>
      <if test="createrCompanyId != null" >
       and creater_company_id = #{createrCompanyId,jdbcType=VARCHAR}
      </if>
      <if test="createrDepId != null" >
       and  creater_dep_id = #{createrDepId,jdbcType=VARCHAR}
      </if>
      <if test="createrGroupId != null" >
       and creater_group_id = #{createrGroupId,jdbcType=VARCHAR}
      </if>
      <if test="appointEmpId != null" >
       and appoint_emp_id = #{appointEmpId,jdbcType=VARCHAR}
      </if>
      <if test="appointEmpName != null" >
       and appoint_emp_name = #{appointEmpName,jdbcType=VARCHAR}
      </if>
      <if test="appointUnionId != null" >
       and appoint_union_id = #{appointUnionId,jdbcType=VARCHAR}
      </if>
      <if test="appointCompanyId != null" >
      and  appoint_company_id = #{appointCompanyId,jdbcType=VARCHAR}
      </if>
      <if test="appointDepId != null" >
       and appoint_dep_id = #{appointDepId,jdbcType=VARCHAR}
      </if>
      <if test="appointGroupId != null" >
       and appoint_group_id = #{appointGroupId,jdbcType=VARCHAR}
      </if>
      <if test="status != null" >
       and status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="businessStatus != null" >
        and  business_status = #{businessStatus,jdbcType=VARCHAR}
      </if>
      <if test="visitCount != null" >
       and visit_count = #{visitCount,jdbcType=INTEGER}
      </if>
      <if test="createTime != null" >
      and  create_time = #{createTime,jdbcType=TIMESTAMP}
      </if>
      <if test="visitTime != null" >
       and visit_time = #{visitTime,jdbcType=TIMESTAMP}
      </if>
      <if test="lastUser != null" >
       and  last_user = #{lastUser,jdbcType=VARCHAR}
      </if>
      <if test="lastModifyTime != null" >
       and last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP}
      </if>
      <if test="source != null" >
       and source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="sourceOrg != null" >
       and source_org = #{sourceOrg,jdbcType=VARCHAR}
      </if>
      <if test="remark != null" >
       and remark = #{remark,jdbcType=VARCHAR}
      </if>
      <if test="field1 != null" >
       and field1 = #{field1,jdbcType=VARCHAR}
      </if>
      <if test="field2 != null" >
       and field2 = #{field2,jdbcType=VARCHAR}
      </if>
      <if test="field3 != null" >
       and field3 = #{field3,jdbcType=VARCHAR}
      </if>
      <if test="field4 != null" >
       and field4 = #{field4,jdbcType=VARCHAR}
      </if>
      <if test="field5 != null" >
       and field5 = #{field5,jdbcType=VARCHAR}
      </if>
      <if test="field6 != null" >
       and field6 = #{field6,jdbcType=VARCHAR}
      </if>
      <if test="field7 != null" >
       and field7 = #{field7,jdbcType=VARCHAR}
      </if>
      <if test="field8 != null" >
       and field8 = #{field8,jdbcType=VARCHAR}
      </if>
      <if test="field9 != null" >
       and field9 = #{field9,jdbcType=VARCHAR}
      </if>
      <if test="field10 != null" >
       and field10 = #{field10,jdbcType=VARCHAR}
      </if>
      <if test="parentId != null" >
       and parent_id = #{parentId,jdbcType=INTEGER}
      </if>
    </where>
  </sql>
  
   <sql id="Where_Common_orderInfor01">
   	    <!-- 客户经理的城市-->
		<if test="appEmpCity != null  and appEmpCity != '' ">
			and le.city_name = #{appEmpCity}
		</if>
		<if test="appBeginingTime != null">
			 AND DATE_FORMAT(a.create_time,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{appBeginingTime},'%Y-%m-%d')
		</if>
		<if test="appEndingTime != null">
			AND DATE_FORMAT(a.create_time,'%Y-%m-%d') &lt;=   DATE_FORMAT(#{appEndingTime},'%Y-%m-%d')
		</if>
  </sql>
  
  <sql id="Where_Common_orderInfor02">
   	    <!-- 客户经理的城市-->
		<if test="appEmpCity != null  and appEmpCity != '' ">
			and le.city_name = #{appEmpCity}
		</if>
		<if test="appBeginingTime != null">
			AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{appBeginingTime},'%Y-%m-%d')
		</if>
		<if test="appEndingTime != null">
			AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &lt;=   DATE_FORMAT(#{appEndingTime},'%Y-%m-%d')
		</if>
  </sql>
  
  
  
  
  <!-- 自定义方法区 -->
  <sql id="Where_Common">
 		 <if test="id != null and id !='' " >
        and a.id =#{id,jdbcType=INTEGER}
      </if>
    <if test="mobile != null and mobile !=''" >
        and a.mobile = #{mobile,jdbcType=VARCHAR}
      </if>
       <if test="custId != null" >
        and a.cust_id = #{custId,jdbcType=VARCHAR}
      </if>
      <if test="name != null and name !=''" >
        and a.name like CONCAT('%', #{name}, '%')
      </if>
      <if test="businessStatus != null and businessStatus!='' " >
        and  a.business_status in(#{businessStatus}) 
      </if>
      <choose>
		
		 <!-- 回访：只有客户经理才能回访，如果没有客户经理创建者可以回访 -->
		<when test="actionType != null and actionType != '' and actionType=='follow' ">
			and (a.appoint_emp_id =#{leEmpId} } or (a.creater_emp_id =#{leEmpId} and a.appoint_emp_id is null))
		</when>
		<!-- 已分配只能查询本公司和本部门下的  -->
		<when test="status != null and  status=='03' ">
			<if test="authgroupList != null">
			 	and 
		         <foreach item="item" index="index" collection="authgroupList" open="(" separator="or" close=")">
			         (1=1
			             <if test="item.orgId != null and item.orgId != ''">
						  		and a.appoint_company_id =  #{item.orgId}
						 </if>
						 <if test="item.deptId != null and item.deptId != ''">
						  		and a.appoint_org =  #{item.deptId}
						 </if>
						 <if test="item.dataOwner != null and item.dataOwner != ''">
						  		and a.appoint_emp_id =  #{item.dataOwner}
						 </if>
					  )
		          </foreach>
			</if>
		</when>
		<otherwise>
			<if test="authgroupList != null">
				 	and 
			         <foreach item="item" index="index" collection="authgroupList" open="(" separator="or" close=")">
				         (1=1
				             <if test="item.orgId != null and item.orgId != ''">
							  	and (a.appoint_company_id=#{item.orgId} or a.creater_company_id =#{item.orgId})
							 </if>
							 <if test="item.deptId != null and item.deptId != ''">
							  	and (a.appoint_org=#{item.deptId} or a.creater_org =#{item.deptId})
							 </if>
							 <if test="item.dataOwner != null and item.dataOwner != ''">
							 	and (a.creater_emp_id =#{item.dataOwner} or a.appoint_emp_id =#{item.dataOwner}) 
							 </if>
						  )
			          </foreach>
				</if>
		</otherwise>
	</choose>
<!-- 
      <choose>
		<when test="companyIdList != null">
			and (a.creater_company_id in
	         <foreach item="item" index="index" collection="companyIdList" open="(" separator="," close=")">
	             #{item}
	          </foreach>
	          or a.appoint_company_id in
	          <foreach item="item" index="index" collection="companyIdList" open="(" separator="," close=")">
	             #{item}
	          </foreach>)
		</when>
		待分配 客户归属公司
		<when test="actionType != null and actionType != '' and actionType=='assign'">
            and (a.appoint_company_id=#{companyId} or a.creater_company_id =#{companyId})
            如果不是领导，只能查看自己创建者或者归属的
            <if test="oaOrgIdList == null">
				and (a.creater_emp_id =#{leEmpId} or a.appoint_emp_id =#{leEmpId})  
			</if>
		</when>
		 回访：只有客户经理才能回访，如果没有客户经理创建者可以回访
		<when test="actionType != null and actionType != '' and actionType=='follow' ">
			and (a.appoint_emp_id =#{leEmpId} } or (a.creater_emp_id =#{leEmpId} and a.appoint_emp_id is null))
		</when>
		已分配只能查询本公司和本部门下的 
		<when test="status != null and  status=='03' ">
			<if test="oaOrgIdList == null">
            	and a.appoint_emp_id =#{leEmpId}
			</if>
			<if test="oaOrgIdList != null">
            	and a.appoint_company_id=#{companyId}
	          	and a.appoint_org in
	            <foreach item="org" index="index" collection="oaOrgIdList" open="(" separator="," close=")">
	             #{org}
	          </foreach>
			</if>
		</when>
         <when test="oaOrgIdList != null">
            	and (a.appoint_company_id=#{companyId} or a.creater_company_id =#{companyId})
			and (a.creater_org in
	         <foreach item="org" index="index" collection="oaOrgIdList" open="(" separator="," close=")">
	             #{org}
	          </foreach>
	          or a.appoint_org in
	            <foreach item="org" index="index" collection="oaOrgIdList" open="(" separator="," close=")">
	             #{org}
	          </foreach>)
		</when>
		<when test="leEmpId!=null">
			and (a.creater_emp_id =#{leEmpId} or a.appoint_emp_id =#{leEmpId})  
		</when>
	</choose> -->
	<if test="unionId != null and unionId != ''">
  		and a.creater_union_id = #{unionId}
  	</if>
  	<if test="province != null and province !='' " >
    	 and a.province = #{province,jdbcType=VARCHAR}
    </if>
    <if test="city != null and city !=''" >
     	and a.city = #{city,jdbcType=VARCHAR}
    </if>
     <if test="appointCompanyId != null and appointCompanyId !='' " >
      and  a.appoint_company_id = #{appointCompanyId,jdbcType=VARCHAR}
     </if>
   <!--  <if test="appointDepId != null and appointDepId !=''" >
    	 and a.appoint_dep_id = #{appointDepId,jdbcType=VARCHAR}
    </if> -->
    <if test="appointDepId != null and '' != appointDepId">
  		and (a.appoint_org = #{appointDepId} or a.creater_org = #{appointDepId} OR find_in_set(#{appointDepId},b.parent_ids)>0)
  	</if>
    <if test="appointGroupId != null and appointGroupId !=''" >
     	and a.appoint_group_id = #{appointGroupId,jdbcType=VARCHAR}
    </if>
  	<if test="appointEmpName != null and appointEmpName !='' and (isCountIntent == null  or isCountIntent == '')" >
    	 and a.appoint_emp_name = #{appointEmpName,jdbcType=VARCHAR}
    </if>
    <if test="appointEmpName != null and appointEmpName !='' and isCountIntent == 'yes'" >
    	 and a.appoint_emp_name like CONCAT('%', #{appointEmpName}, '%')
    </if>
  	<!-- <if test="businessType != null" >
     	and a.business_type = #{businessType,jdbcType=INTEGER}
    </if> -->
    
    <if test="status != null and  status!='' " >
       and a.status = #{status,jdbcType=VARCHAR}
    </if>
   	<if test="grade != null and  grade!='' " >
     	and a.grade = #{grade,jdbcType=VARCHAR}
    </if>
    <if test="source != null and  source!='' " >
     	and a.source = #{source,jdbcType=VARCHAR}
    </if>
    <if test="beginingTime != null  and (isCountIntent == null  or isCountIntent == '') ">
		AND DATE_FORMAT(a.last_modify_time,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m-%d')
	</if>
	<if test="endingTime != null and (isCountIntent == null  or isCountIntent == '')  ">
		AND DATE_FORMAT(a.last_modify_time,'%Y-%m-%d') &lt;=DATE_FORMAT(#{endingTime},'%Y-%m-%d')
	</if>
	<if test="dateFlag != null  and dateFlag != '' and dateFlag == '01'">
		and (to_days(a.last_modify_time) = to_days(now()))
	</if>
	<if test="dateFlag != null  and dateFlag != '' and dateFlag == '02'">
		and  (to_days(now()) - to_days(a.last_modify_time)>=1 and to_days(now()) - to_days(a.last_modify_time)&lt;2)
	</if>
	
	<if test="dateFlag != null  and dateFlag != '' and dateFlag == '03'">
		and (DATE_SUB(CURDATE(), INTERVAL 7 DAY) &lt;= date(a.last_modify_time))
	</if>
	<if test="dateFlag != null  and dateFlag != '' and dateFlag == '04'">
		and (DATE_SUB(CURDATE(), INTERVAL 30 DAY) &lt;= date(a.last_modify_time))
	</if>
	
	<!-- 是否是统计意向客户 -->
	<if test="isCountIntent != null  and isCountIntent != '' and isCountIntent == 'yes'">
		and a.appoint_emp_id IS NOT NULL AND a.appoint_emp_id != ""
	</if>
	
  </sql>
  
  <!-- 分页列表 -->
    <select id="queryList" resultType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
   	select a.*,b.parentDepeName as appointDeptName,c.company_name as appointCompanyName,b.name as appointGroupName,b1.parentDepeName as createrDeptName,c1.company_name as createrCompanyName,b1.name as createrGroupName, lpp.product_type productType 
	from crm_intent_loan_user a 
	left join  
	(
		SELECT
			e.*, IFNULL(de.name, e.name) AS parentDepeName
		FROM
			bump_dept e
		LEFT JOIN bump_dept de ON e.parent_id = de.dept_id
	)b  on a.appoint_org = b.dept_id 
	left join bump_union_company  c  on  a.appoint_company_id = c.company_id
	left join 
	(
		SELECT
			e.*, IFNULL(de.name, e.name) AS parentDepeName
		FROM
			bump_dept e
		LEFT JOIN bump_dept de ON e.parent_id = de.dept_id
	)b1  on a.creater_org = b1.dept_id 
	left join bump_union_company  c1  on  a.creater_company_id = c1.company_id
	left join loan_parent_product lpp on a.business_type=lpp.product_no
   <where>
       <include refid="Where_Common"/>
   </where>
   order by a.last_modify_time desc
    <if test="page!=null and page.pageStartIndex != null and page.pageSize != null">
    	Limit #{page.pageStartIndex},#{page.pageSize}
    </if>
   </select>
   <select id="queryCount" resultType="int" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    <!-- select  count(1)  from crm_intent_loan_user a -->
     	select count(1)
		from crm_intent_loan_user a 
		left join  
		(
			SELECT
				e.*, IFNULL(de.name, e.name) AS parentDepeName
			FROM
				bump_dept e
			LEFT JOIN bump_dept de ON e.parent_id = de.dept_id
		)b  on a.appoint_org = b.dept_id 
		left join bump_union_company  c  on  a.appoint_company_id = c.company_id
		left join 
		(
			SELECT
				e.*, IFNULL(de.name, e.name) AS parentDepeName
			FROM
				bump_dept e
			LEFT JOIN bump_dept de ON e.parent_id = de.dept_id
		)b1  on a.creater_org = b1.dept_id 
		left join bump_union_company  c1  on  a.creater_company_id = c1.company_id
		left join loan_parent_product lpp on a.business_type=lpp.product_no
	   <where>
	       <include refid="Where_Common"/>
	   </where>
  </select>
  
  <!-- 根据手机号查询 -->
   <select id="findbyMobile" resultType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" parameterType="String" >
    select <include refid="Base_Column_List" />
    from crm_intent_loan_user  where mobile =#{mobile} limit 1
   </select>
  
   <select id="selectIntentUserByOrder" resultType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" >
    select *
    from crm_intent_loan_user  where id =#{id}
   </select>

   
   <!-- 根据条件统计意向客户（以意向客户表中的客户经理为维度） -->
   <select id="getcrmIntentUserCountList"  parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" resultType="com.lhhs.loan.dao.domain.CrmIntentLoanUser">
		SELECT
			a.*, b.dealCount AS dealCount,
			c.mianshenCount AS mianshenCount,
			d.intentCount AS intentCount,
			le.city_name AS appEmpCity,
			le.create_time AS appointCreateTime,
			e.parentDepeName AS appointDeptName,
			f.company_name AS appointCompanyName,
			e.name AS appointGroupName
		FROM
			(
				SELECT
					a.*
				FROM
					crm_intent_loan_user a
				LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
				LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id 
				<where>
					<include refid="Where_Common"/>
					<include refid="Where_Common_orderInfor01"/>
				</where>
				GROUP BY
					a.appoint_emp_id
			) a
		LEFT JOIN (
			SELECT
				count(DISTINCT luo.order_no) AS dealCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
			LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				ac.task_def_key = "fangkuan_zx"
			AND (
				ac. STATUS = "90"
				OR ac. STATUS = "03"
			) 
			<include refid="Where_Common"/>
			<include refid="Where_Common_orderInfor02"/>
			GROUP BY
				a.appoint_emp_id
		) b ON a.appoint_emp_id = b.customerId
		LEFT JOIN (
			SELECT
				count(DISTINCT luo.order_no) AS mianshenCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
			LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				ac.task_def_key = "mianshen" 
				<include refid="Where_Common"/>
				<include refid="Where_Common_orderInfor02"/>
			GROUP BY
				a.appoint_emp_id
		) c ON a.appoint_emp_id = c.customerId
		LEFT JOIN (
			SELECT
				count(*) AS intentCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				1 = 1 
				<include refid="Where_Common"/>
				<include refid="Where_Common_orderInfor01"/>
			GROUP BY
				a.appoint_emp_id
		) d ON a.appoint_emp_id = d.customerId
		LEFT JOIN (
			SELECT
				e.*, IFNULL(de.name, e.name) AS parentDepeName
			FROM
				bump_dept e
			LEFT JOIN bump_dept de ON e.parent_id = de.dept_id
		) e ON a.appoint_dep_id = e.dept_id
		LEFT JOIN bump_union_company f ON a.appoint_company_id = f.company_id
		LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
		WHERE
			1 = 1
		<include refid="Where_Common_orderInfor01"/>
    order by intentCount desc
    <if test="page!=null and page.pageStartIndex != null and page.pageSize != null">
    	Limit #{page.pageStartIndex},#{page.pageSize}
    </if>
   </select>
   
   
   <!-- 根据条件统计意向客户的数量（以意向客户表中的客户经理为维度） -->
   <select id="getcrmIntentUserCountNum" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" resultType="int">
		SELECT
			count(*)
		FROM
			(
				SELECT
					a.*, b.dealCount AS dealCount,
					c.mianshenCount AS mianshenCount,
					d.intentCount AS intentCount
				FROM
					(
						SELECT
							a.*
						FROM
							crm_intent_loan_user a
						LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
						LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id 
						<where>
							<include refid="Where_Common"/>
							<include refid="Where_Common_orderInfor01"/>
						</where>
						GROUP BY
							a.appoint_emp_id
					) a
				LEFT JOIN (
					SELECT
						count(DISTINCT luo.order_no) AS dealCount,
						a.appoint_emp_id AS customerId
					FROM
						crm_intent_loan_user a
					LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
					LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
					LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
					LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
					WHERE
						ac.task_def_key = "fangkuan_zx"
					AND (
						ac. STATUS = "90"
						OR ac. STATUS = "03"
					) 
					<include refid="Where_Common"/>
					<include refid="Where_Common_orderInfor02"/>
					GROUP BY
						a.appoint_emp_id
				) b ON a.appoint_emp_id = b.customerId
				LEFT JOIN (
					SELECT
						count(DISTINCT luo.order_no) AS mianshenCount,
						a.appoint_emp_id AS customerId
					FROM
						crm_intent_loan_user a
					LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
					LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
					LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
					LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
					WHERE
						ac.task_def_key = "mianshen" 
						<include refid="Where_Common"/>
						<include refid="Where_Common_orderInfor02"/>
					GROUP BY
						a.appoint_emp_id
				) c ON a.appoint_emp_id = c.customerId
				LEFT JOIN (
					SELECT
						count(*) AS intentCount,
						a.appoint_emp_id AS customerId
					FROM
						crm_intent_loan_user a
					LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
					LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
					WHERE
						1 = 1 
						<include refid="Where_Common"/>	
						<include refid="Where_Common_orderInfor01"/>
					GROUP BY
						a.appoint_emp_id
				) d ON a.appoint_emp_id = d.customerId
				LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
				WHERE
					1 = 1 
					<include refid="Where_Common_orderInfor01"/>
				ORDER BY
					intentCount DESC
			) e
   </select>
   
   <!-- 根据条件统计客户总量 约见总量 签约总量 -->
   <select id="getVariousTotalCount" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser" resultType="map">
		SELECT
			sum(b.dealCount) AS dealTotalCount,
			sum(c.mianshenCount) AS mianshenTotalCount,
			sum(d.intentCount) AS intentTotalCount
		FROM
			(
				SELECT
					a.*
				FROM
					crm_intent_loan_user a
				LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
				LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id 
				<where> 
					<include refid="Where_Common"/>
					<include refid="Where_Common_orderInfor01"/>
				</where>
				GROUP BY
					a.appoint_emp_id
			) a
		LEFT JOIN (
			SELECT
				count(DISTINCT luo.order_no) AS dealCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
			LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				ac.task_def_key = "fangkuan_zx"
			AND (
				ac. STATUS = "90"
				OR ac. STATUS = "03"
			) 
			<include refid="Where_Common"/>
			<include refid="Where_Common_orderInfor02"/>
			GROUP BY
				a.appoint_emp_id
		) b ON a.appoint_emp_id = b.customerId
		LEFT JOIN (
			SELECT
				count(DISTINCT luo.order_no) AS mianshenCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
			LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				ac.task_def_key = "mianshen" 
				<include refid="Where_Common"/>
				<include refid="Where_Common_orderInfor02"/>
			GROUP BY
				a.appoint_emp_id
		) c ON a.appoint_emp_id = c.customerId
		LEFT JOIN (
			SELECT
				count(*) AS intentCount,
				a.appoint_emp_id AS customerId
			FROM
				crm_intent_loan_user a
			LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
			LEFT JOIN bump_dept b ON a.appoint_dep_id = b.dept_id
			WHERE
				1 = 1 
				<include refid="Where_Common"/>
				<include refid="Where_Common_orderInfor01"/>
			GROUP BY
				a.appoint_emp_id
		) d ON a.appoint_emp_id = d.customerId
		LEFT JOIN bump_user le ON a.appoint_emp_id = le.user_id
		WHERE
			1 = 1
		<include refid="Where_Common_orderInfor01"/>
   </select>
    
   
   <!-- 根据时间统计签约总量 -->
   <select id="getDealCountByTime" resultType="map" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser">
       select sum(totalDealCount) as totalDealCount,createTime<if test='weekNum !=null and weekNum !="" '>,time</if> from 
       (
       	 SELECT
			count(DISTINCT luo.order_no) AS totalDealCount,
			(case 
				when #{timeUnit}="月" then DATE_FORMAT(ac.task_end_date, '%Y-%m') 
				else DATE_FORMAT(ac.task_end_date, '%Y-%m-%d') 
			end)  createTime
			<if test='weekNum !=null and weekNum !="" '>
				,(case 
					when #{timeUnit}="周" and #{weekNum}="01"  then "第一周"
					when #{timeUnit}="周" and #{weekNum}="02"  then "第二周"
					when #{timeUnit}="周" and #{weekNum}="03"  then "第三周"
					when #{timeUnit}="周" and #{weekNum}="04"  then "第四周"
				end)  time
		    </if>
		FROM
			crm_intent_loan_user a
		LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
		LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
		left join bump_user le on a.appoint_emp_id = le.user_id
		<where>
	      	<include refid="Where_Common"/>
	  	</where>
		and	ac.task_def_key = "fangkuan_zx"
		AND (
			ac. STATUS = "90"
			OR ac. STATUS = "03"
		)
		<if test='timeUnit != null  and timeUnit != "" and timeUnit == "月"'>
			 AND DATE_FORMAT(ac.task_end_date,'%Y-%m') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m')
			 AND DATE_FORMAT(ac.task_end_date,'%Y-%m') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m')
		</if>
		<if test='timeUnit == "周"  and weekNum=="01" '>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-3)  
		</if>
		<!-- 第二周 -->
		<if test='timeUnit == "周"  and weekNum=="02"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-2)  
		</if>
		<!-- 第三周 -->
		<if test='timeUnit == "周"  and weekNum=="03"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-1)  
		</if>
		<!-- 第四周 -->
		<if test='timeUnit == "周"  and weekNum=="04"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1))  
		</if>
		<if test='timeUnit != null  and timeUnit != "" and timeUnit == "日"'>
			 AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m-%d')
		     AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m-%d')
		</if>
		GROUP BY luo.order_no
       )e
        GROUP BY 
        <if test='weekNum !=null and weekNum !="" '>time</if>
        <if test='weekNum ==null or weekNum =="" '>e.createTime</if>
        order by e.createTime
   </select>
   
   
  
   <!-- 根据时间统计约见总量 -->
   <select id="getMianshenCountByTime" resultType="map" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser">
  		select sum(totalMianshenCount) as totalMianshenCount,createTime <if test='weekNum !=null and weekNum !="" '>,time</if> from
  		(
	  		SELECT
				count(DISTINCT luo.order_no) AS totalMianshenCount,
				(case 
					when #{timeUnit}="月" then DATE_FORMAT(ac.task_end_date, '%Y-%m') 
					else DATE_FORMAT(ac.task_end_date, '%Y-%m-%d') 
				end)  createTime
				<if test='weekNum !=null and weekNum !="" '>
					,(case 
						when #{timeUnit}="周" and #{weekNum}="01"  then "第一周"
						when #{timeUnit}="周" and #{weekNum}="02"  then "第二周"
						when #{timeUnit}="周" and #{weekNum}="03"  then "第三周"
						when #{timeUnit}="周" and #{weekNum}="04"  then "第四周"
					end)  time
				</if>
			FROM
				crm_intent_loan_user a
			LEFT JOIN loan_user_order luo ON a.id = luo.intent_user_id
			LEFT JOIN act_comment ac ON luo.order_no = ac.business_id
			left join bump_user le on a.appoint_emp_id = le.user_id
			<where>
		      	<include refid="Where_Common"/>
		  	</where>
			AND	ac.task_def_key = "mianshen"
			<if test='timeUnit != null  and timeUnit != "" and timeUnit == "月"'>
				 AND DATE_FORMAT(ac.task_end_date,'%Y-%m') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m')
				 AND DATE_FORMAT(ac.task_end_date,'%Y-%m') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m')
			</if>
		<!-- 第一周 -->
		<if test='timeUnit == "周"  and weekNum=="01" '>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-3)  
		</if>
		<!-- 第二周 -->
		<if test='timeUnit == "周"  and weekNum=="02"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-2)  
		</if>
		<!-- 第三周 -->
		<if test='timeUnit == "周"  and weekNum=="03"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-1)  
		</if>
		<!-- 第四周 -->
		<if test='timeUnit == "周"  and weekNum=="04"'>
			AND (WEEK(date_format(ac.task_end_date,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1))  
		</if>
		<if test='timeUnit != null  and timeUnit != "" and timeUnit == "日"'>
			 AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m-%d')
		     AND DATE_FORMAT(ac.task_end_date,'%Y-%m-%d') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m-%d')
		</if>
		 GROUP BY luo.order_no
  		)e
  		 GROUP BY 
  		  <if test='weekNum !=null and weekNum !="" '>time</if>
  		  <if test='weekNum ==null or weekNum =="" '>e.createTime</if>
  		order by e.createTime
   </select>
   
   
   
   <!-- 根据时间统计客户总量 -->
    <select id="getIntentCountByTime" resultType="map" parameterType="com.lhhs.loan.dao.domain.CrmIntentLoanUser">
	   	SELECT
			count(*) AS totalIntentCount,
			(case 
				when #{timeUnit}="月" then DATE_FORMAT(a.create_time, '%Y-%m') 
				else DATE_FORMAT(a.create_time, '%Y-%m-%d') 
			end)  createTime
			<if test='weekNum !=null and weekNum !="" '>
				,(case 
					when #{timeUnit}="周" and #{weekNum}="01"  then "第一周"
					when #{timeUnit}="周" and #{weekNum}="02"  then "第二周"
					when #{timeUnit}="周" and #{weekNum}="03"  then "第三周"
					when #{timeUnit}="周" and #{weekNum}="04"  then "第四周"
				end)  time
			</if>
			
		FROM
			crm_intent_loan_user a
		left join bump_user le on a.appoint_emp_id = le.user_id
		<where>
	      	<include refid="Where_Common"/>
	  	</where>
		<if test='timeUnit != null  and timeUnit != "" and timeUnit == "月"'>
			 AND DATE_FORMAT(a.create_time,'%Y-%m') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m')
			 AND DATE_FORMAT(a.create_time,'%Y-%m') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m')
			 GROUP BY DATE_FORMAT(a.create_time, '%Y-%m')
		</if>
		<!-- 第一周 -->
		<if test='timeUnit == "周"  and weekNum=="01" '>
			AND (WEEK(date_format(a.create_time,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-3)  
			GROUP BY  WEEK(date_format(a.create_time,'%Y-%m-%d'),1)      
		</if>
		<!-- 第二周 -->
		<if test='timeUnit == "周"  and weekNum=="02"'>
			AND (WEEK(date_format(a.create_time,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-2)  
			GROUP BY  WEEK(date_format(a.create_time,'%Y-%m-%d'),1)   
		</if>
		<!-- 第三周 -->
		<if test='timeUnit == "周"  and weekNum=="03"'>
			AND (WEEK(date_format(a.create_time,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1)-1)  
			GROUP BY  WEEK(date_format(a.create_time,'%Y-%m-%d'),1)   
		</if>
		<!-- 第四周 -->
		<if test='timeUnit == "周"  and weekNum=="04"'>
			AND (WEEK(date_format(a.create_time,'%Y-%m-%d'),1) = WEEK(date_format(now(),'%Y-%m-%d'),1))  
			GROUP BY  WEEK(date_format(a.create_time,'%Y-%m-%d'),1)   
		</if>
		<if test='timeUnit != null  and timeUnit != "" and timeUnit == "日"'>
			 AND DATE_FORMAT(a.create_time,'%Y-%m-%d') &gt;=   DATE_FORMAT(#{beginingTime},'%Y-%m-%d')
		     AND DATE_FORMAT(a.create_time,'%Y-%m-%d') &lt;=   DATE_FORMAT(#{endingTime},'%Y-%m-%d')
		     GROUP BY DATE_FORMAT(a.create_time, '%Y-%m-%d')
		</if>
		order by a.create_time asc
   </select>
  
   
   
  
</mapper>